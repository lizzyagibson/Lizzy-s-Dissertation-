% Initialization
\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{GSAS}[2021]

% Only works with the memoir class!
\@ifclassloaded{memoir}{\let\endpwGSAS\relax}{\let\endpwGSAS\endinput
\PackageError{GSAS}{The GSAS package only works with the memoir class}%
{\@ehd}}
\endpwGSAS

\usepackage{url}
\urlstyle{same}
\setverbatimfont{\normalfont}% make verbatims use the body font

\renewcommand*{\foottextfont}{\normalfont\normalsize}

% To enable spacing to be changed if necessary by the user
\newcommand*{\setGSASspacing}[1]{%
\let\GSASSpacing#1
\GSASSpacing}
\setGSASspacing{\DoubleSpacing}

% Page layout
% left, right margins and text width
\setlrmarginsandblock{1in}{1in}{*}

% for main body, bottom of text at 1in, footer below
% top of header at 1in, first text line double spaced
% below base of header
\newlength{\linespace}
\setlength{\linespace}{\baselineskip} % current equivalent of \onelineskip
\setlength{\headheight}{\onelineskip}
\setlength{\headsep}{\linespace}
\addtolength{\headsep}{-\topskip}
\setlength{\uppermargin}{1in}
\addtolength{\uppermargin}{\headheight}
\addtolength{\uppermargin}{\headsep}

% and for the bottom
\setlength{\lowermargin}{1in}
\setlength{\textheight}{\paperheight}
\addtolength{\textheight}{-\uppermargin}
\addtolength{\textheight}{-\lowermargin}

% footnote settings
\setlength{\footskip}{\onelineskip}
\setlength{\footnotesep}{\onelineskip}

% the fiddle lengths (..ta.. for title/approval page, others for prelims)
\newlength{\toptafiddle} \setlength{\toptafiddle}{2\linespace}
\newlength{\bottafiddle} \setlength{\bottafiddle}{0pt}
\newlength{\topfiddle} \setlength{\topfiddle}{\toptafiddle}
\newlength{\botfiddle} \setlength{\botfiddle}{\onelineskip}

\setlength{\parindent}{2em}
\checkandfixthelayout[nearest]

\newcommand*{\addtotextheight}[1]{%
\twocolumn
\addtolength{\textheight}{#1}%
\onecolumn}

% Page styles
% the main text
\makepagestyle{GSAS}
\makeevenhead{GSAS}{\thepage}{}{}
\makeoddhead{GSAS}{}{}{\thepage}

% for continuation pages of the ToC, LoF, LoT
\makepagestyle{toc}
\makeevenfoot{toc}{}{\thepage}{}
\makeoddfoot{toc}{}{\thepage}{}
\makeevenhead{toc}{Chapter}{}{Page}
\makeoddhead{toc}{Chapter}{}{Page}
\makepagestyle{lof}
\makeevenfoot{lof}{}{\thepage}{}
\makeoddfoot{lof}{}{\thepage}{}
\makeevenhead{lof}{Figure}{}{Page}
\makeoddhead{lof}{Figure}{}{Page}
\makepagestyle{lot}
\makeevenfoot{lot}{}{\thepage}{}
\makeoddfoot{lot}{}{\thepage}{}

% The LoF
\renewcommand{\listfigurename}{List of Figures}
\addtodef{\listoffigures}{\clearpage\pagestyle{lof}}{}

% The LoT
\renewcommand{\listtablename}{List of Tables}
\addtodef{\listoftables}{\clearpage\pagestyle{lot}}{}
\renewcommand*{\lotheadstart}{\vspace*{-\topfiddle}}
\renewcommand*{\afterlottitle}{\thispagestyle{plain}
    \par\nobreak \par\nobreak}

% Do the ToC
\renewcommand{\contentsname}{Table of Content}
\addtodef{\tableofcontents}{\clearpage\pagestyle{toc}}{}
\renewcommand*{\tocheadstart}{\vspace*{-\topfiddle}}
\renewcommand*{\aftertoctitle}{\thispagestyle{plain}\par\nobreak \mbox{}\hfill{}\par\nobreak}

\renewcommand*{\cftchapterfont}{\normalfont}
\renewcommand*{\cftchapterpagefont}{\normalfont}
\renewcommand*{\cftchapterleader}{%
\cftchapterfont\cftdotfill{\cftchapterdotsep}}
\renewcommand*{\cftchapterdotsep}{\cftdotsep}

% no extra space before the entry, or in the LoF/LoT
\setlength{\cftbeforechapterskip}{0pt plus 0pt}
\renewcommand*{\insertchapterspace}{}

% chapter style
% \makechapterstyle{GSAS}{%
% \setlength{\beforechapskip}{-\topfiddle}
% \setlength{\midchapskip}{1.0\onelineskip}
% \setlength{\afterchapskip}{1.0\onelineskip}
%\renewcommand*{\chapnamefont}{\normalfont}
% \renewcommand*{\chapnumfont}{\chapnamefont}
%\renewcommand*{\printchapternum}{\centering\chapnumfont \thechapter}
%\renewcommand*{\chaptitlefont}{\normalfont\centering}
% \renewcommand*{\printchapternonum}{}}
% \aliaspagestyle{chapter}{empty}

% chapter style for appendices, text comes on following page
\makechapterstyle{GSASappendix}{%
\setlength{\beforechapskip}{-\topfiddle}
\setlength{\midchapskip}{1.0\onelineskip}
\setlength{\afterchapskip}{1.0\onelineskip}
\renewcommand*{\chapnamefont}{\normalfont}
\renewcommand*{\chapnumfont}{\chapnamefont}
\renewcommand*{\printchaptername}{%
\chapnamefont\MakeUppercase{\@chapapp}}
\renewcommand*{\printchapternum}{\centering\chapnumfont \thechapter}
\renewcommand*{\chaptitlefont}{\normalfont\centering}
\renewcommand*{\printchapternonum}{}
\renewcommand*{\afterchaptertitle}{\clearpage}}

% different chapter style for appendices, (and double spaced)
\addtodef{\appendix}{}{\chapterstyle{GSASappendix}\GSASSpacing}

% (subsub)section styles
\setbeforesecskip{-1\onelineskip plus -1ex minus -.2ex}
\setaftersecskip{1\onelineskip plus .2ex}
\setbeforesubsecskip{-1\onelineskip plus -1ex minus -.2ex}
\setaftersubsecskip{1\onelineskip plus .2ex}

% Captions
\captiontitlefont{\normalfont}% title font
\precaption{\raggedright}% for Caption N
\captiondelim{\newline}% newline
\captionstyle{\raggedright}% for title
\setlength{\belowcaptionskip}{\onelineskip}

% for REFERENCE section
\renewcommand*{\bibname}{\centering Bibliography}
\setlength{\bibitemsep}{\onelineskip}
\renewcommand*{\biblistextra}{%
\setlength{\itemsep}{\bibitemsep}
\setlength{\labelwidth}{0pt}
\setlength{\leftmargin}{3em}% hanging indent
\setlength{\itemindent}{-\leftmargin}}

\renewcommand*{\bibsection}{%
\GSASSpacing
\chapter*{\bibname}\phantomsection\addcontentsline{toc}{chapter}{\bibname}
\SingleSpacing}

% endnotes
% \renewcommand*{\notesname}{NOTES}
% \renewcommand*{\notedivision}{%
% \GSASSpacing
% \chapter*{\notesname}
% \addcontentsline{toc}{chapter}{\notesname}
% \SingleSpacing}

% \continuousnotenums
% \renewcommand*{\notenuminnotes}[1]{\textsuperscript{#1}\space}
% \renewcommand{\noteinnotes}[1]{#1\\}
% \renewcommand*{\pagenotesubhead}[3]{}% no subheads

% general macro for Abstract, etc., headings
\newcommand*{\pretoctitle}[1]{{\clearpage\centering
\vspace*{-\topfiddle}#1\par}}

% Start the ACKNOWLEDGEMENTS
\newcommand{\GSASacknowledgements}{\pretoctitle{Acknowledgements}}

% Start the ABSTRACT
\newcommand{\GSASabstract}{%
\addtotextheight{-\botfiddle}%
\pretoctitle{Abstract}}

% make it easy to center any dedication
\newcommand{\GSASdedication}[1]{%
{\clearpage\mbox{}\vfill\centering #1 \par\vfill\clearpage}}

% for any headings after the tocloft and before the main body
\newcommand{\prelimtitle}[1]{%
\pretoctitle{#1}\phantomsection\addcontentsline{toc}{chapter}{#1}}

% for the title page and approval page.
% your title
\newcommand{\settitle}[1]{\def\GSAStitle{#1}}
% you
\newcommand{\setauthor}[1]{\def\GSASauthor{#1}}
% title page
\settitle{Statistical and Machine Learning Methods for Pattern Identification in Environmental Mixtures}
\setauthor{Elizabeth Atkeson Gibson}

% typesets the TITLE page
\newcommand{\thetitlepage}{{%
\clearpage
\thispagestyle{empty}
\centering
\vspace*{\fill}
{\huge\textbf{\GSAStitle}} \\ \ \\ by \\ \GSASauthor
\vfill
{\SingleSpace
Submitted in partial fulfillment of the\\
  requirements for the degree of\\
  Doctor of Philosophy\\
  under the Executive Committee \\
  of the Graduate School of Arts and Sciences \\
}
\vfill
Columbia University  \\
2021
\clearpage}}

%% end of *.sty file
\endinput
%%


